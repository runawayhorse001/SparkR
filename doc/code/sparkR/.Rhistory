knitr::opts_chunk$set(echo = TRUE)
df <- createDataFrame(longley)
df <- createDataFrame(longley)
sparkR.session(sparkPackages = "com.databricks:spark-avro_2.11:3.0.0")
library(SparkR)
sparkR.session(sparkPackages = "com.databricks:spark-avro_2.11:3.0.0")
library(SparkR)
sparkR.session() # optinon (sparkPackages = "com.databricks:spark-avro_2.11:3.0.0")
knitr::opts_chunk$set(echo = TRUE)
library(SparkR)
sparkR.session() # optinon (sparkPackages = "com.databricks:spark-avro_2.11:3.0.0")
df <- createDataFrame(longley)
df.show(5)
head(df)
plot(df.GNP)
plot(df)
plot(df$GNP)
# Register this SparkDataFrame as a temporary view.
createOrReplaceTempView(df, "df")
df <- createDataFrame(cars)
head(df)
# Register this SparkDataFrame as a temporary view.
createOrReplaceTempView(df, "df")
plot(df$speed)
head(df)
schema(df)
df <- createDataFrame(longley)
schema(df)
head(df)
# Register this SparkDataFrame as a temporary view.
createOrReplaceTempView(df, "df")
# SQL statements can be run by using the sql method
test <- sql("SELECT GNP FROM df WHERE Year >= 1947")
head(test)
# SQL statements can be run by using the sql method
test <- sql("SELECT GNP, Year FROM df WHERE Year >= 1947")
head(test)
plot(df$Year,df$Population)
model <- spark.gbt(df, Employed ~ ., type = "regression", maxDepth = 5, maxBins = 16)
summary(model)
library(SparkR)
sparkR.session() # optinon (sparkPackages = "com.databricks:spark-avro_2.11:3.0.0")
df <- createDataFrame(longley)
schema(df)
head(df)
# Register this SparkDataFrame as a temporary view.
createOrReplaceTempView(df, "df")
# SQL statements can be run by using the sql method
test <- sql("SELECT GNP, Year FROM df WHERE Year >= 1947")
head(test)
model <- spark.gbt(df, Employed ~ ., type = "regression", maxDepth = 5, maxBins = 16)
predictions <- predict(model, df)
head(predictions)
library(sparklyr)
library(dplyr)
library(nycflights13)
install.packages("nycflights13")
library(sparklyr)
library(dplyr)
library(nycflights13)
library(ggplot2)
sc <- spark_connect(master="local")
library(sparklyr)
library(dplyr)
library(nycflights13)
library(ggplot2)
sc <- spark_connect(master="local")
flights <- copy_to(sc, flights, "flights")
